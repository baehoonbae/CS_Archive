## 페이지

- 디스크에서 4KB(또는 8KB) 덩어리 하나
- DBMS가 이 덩어리를 → **헤더 + 데이터 영역** 으로 나눠서 설계

## 기본 구조

```
4KB Page Example:

[Page Header] - 페이지 자체의 메타 데이터
- type = Data
- slotCount = 3
- freeSpaceOffset = 800

[Slot Directory] - 각 레코드가 페이지의 어디에 있는가?
- Slot 0: offset 300
- Slot 1: offset 400
- Slot 2: offset 700

[Free Space] - 아무것도 쓰지 않은 공간
- 800 ~ 4096 (아직 비어 있음)

[Record Data Area] - 진짜 레코드들이 저장된 공간
- Record at 300
- Record at 400
- Record at 700
```

## 1️⃣ 페이지 크기 (Page Size)

✔️ **뜻**

> 페이지 하나의 “덩어리 크기”. 디스크에서 읽거나 쓸 때 한 번에 처리하는 단위.
> 

✔️ **비유**

> 택배 상자 크기. 물건이 작아도 상자 크기만큼 공간 차지함.
> 

✔️ **OLTP 특징**

> 랜덤으로 여기저기서 조금씩 꺼내 쓰니까 → 너무 크면 낭비.
> 
> 
> → 4KB ~ 8KB가 딱 좋음.
> 

---

## 2️⃣ Slot Directory

✔️ **뜻**

> 페이지 안에서 레코드(행)들의 위치를 가리키는 주소록.
> 

✔️ **비유**

> 책의 목차. “3장은 45쪽부터”라고 알려줌.
> 

✔️ **왜 필요?**

> 레코드 크기가 달라지면 페이지 안에서 어디 있는지 찾기 위해.
> 

---

## 3️⃣ Variable-length Records

✔️ **뜻**

> 저장하는 데이터(레코드) 크기가 일정하지 않음.
> 

✔️ **비유**

> 책에 긴 글, 짧은 글 섞여 있음.
> 

✔️ **왜 중요?**

> 사용자 이름이 “A”인 사람도 있고 “Jonathan Smith”인 사람도 있음.
> 
> 
> → 고정 길이로 낭비하지 않게 설계.
> 

---

## 4️⃣ Free Space Management

✔️ **뜻**

> 페이지 안의 빈 공간을 어떻게 추적하고 관리할지.
> 

✔️ **비유**

> 노트에서 빈 페이지 찾는 것. 쓰다 지운 자리도 재활용해야 함.
> 

✔️ **왜 필요?**

> 삭제/업데이트가 자주 발생하면 → 공간이 구멍투성이가 됨.
> 

---

## 5️⃣ Dirty Page

✔️ **뜻**

> 메모리에 로드된 페이지가 디스크와 달라진 상태.
> 

✔️ **비유**

> 워드 문서 수정했는데 아직 저장 안 누른 상태.
> 

✔️ **왜 관리?**

> 나중에 디스크에 “저장”해야 함. → 어떤 페이지가 수정됐는지 추적.
> 

---

## 6️⃣ Flush

✔️ **뜻**

> Dirty page를 디스크에 쓰는 것.
> 

✔️ **비유**

> “저장 버튼” 누르기.
> 

✔️ **왜 필요?**

> 메모리에서만 수정되면 컴퓨터 꺼지면 날아감.
> 

---

## 7️⃣ Write-Ahead Logging (WAL)

✔️ **뜻**

> 디스크에 페이지를 쓰기 전에 변경 내역을 먼저 로그에 기록.
> 

✔️ **비유**

> 수정 전후를 일기장에 먼저 써두기. 문제 생기면 되돌릴 수 있게.
> 

✔️ **왜 필요?**

> 갑자기 꺼져도 변경 내역을 로그에서 재생해서 복구.
> 

---

## 8️⃣ Page Split / Merge

✔️ **뜻**

> 한 페이지에 데이터가 너무 꽉 차면 → 두 페이지로 나눔(Split).
> 
> 
> 데이터가 줄어 비면 → 페이지를 합침(Merge).
> 

✔️ **비유**

> 학생 너무 많으면 교실 두 개로 나누고, 줄면 다시 합침.
> 

✔️ **왜 필요?**

> 인덱스(B+Tree)가 균형을 유지하게.
> 

---

## 📌 정리표

| 용어 | 아주 쉬운 뜻 | 비유 |
| --- | --- | --- |
| 페이지 크기 | 한 번에 읽는 덩어리 크기 | 택배 상자 크기 |
| Slot Directory | 페이지 안 레코드 주소록 | 책의 목차 |
| Variable-length Records | 길이가 제각각인 데이터 | 긴 글, 짧은 글 섞인 책 |
| Free Space Management | 빈 공간 재활용 관리 | 노트의 빈 페이지 찾기 |
| Dirty Page | 수정됐지만 저장 안 된 상태 | 워드 문서 저장 전 |
| Flush | 수정 내용을 디스크에 저장 | 저장 버튼 누르기 |
| WAL | 변경 전후 로그 기록 | 일기장에 수정 내역 쓰기 |
| Page Split/Merge | 너무 많아지면 나누기, 적으면 합치기 | 교실 나누고 합치기 |